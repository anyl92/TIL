# 1. Call Stack, Event Loop

*JavaScript*는 단일 스레드 언어이다. 즉, 한 번에 하나의 작업이나 하나의 코드 조각만 처리할 수 있다.

- **콜 스택**

  우리가 프로그램에서 어디에 있는지를 기록하는 데이터 구조이다.
  무한 루프처럼 함수 호출횟수가 너무 많으면 Max Stack Error가 발생한다.
  크롬의 경우 스택의 크기가 16,000 프레임이다.

- **힙**

  구조화되지 않은 넓은 메모리 영역을 지칭한다. 변수와 객체에 대한 모든 할당이 힙 영역에서 이루어진다.

- **큐**

  자바스크립트 런타임에는 메시지 큐도 있다. 각 메시지에는 메시지를 처리하기 위해 호출되는 관련 함수가 있다. 스택에 여유공간이 있을 때, 런타임은 큐에서 메시지를 꺼내어 처리한다. 메시지는 관련 함수를 호출한다(스택 프레임 생성).
  메시지들은 외부 비동기 이벤트에 대한 응답으로 큐에 존재한다. 예를 들어 사용자가 버튼을 클릭했는데 콜백 함수가 없다면 큐에 아무런 메시지도 추가되지 않는다.

- **이벤트 루프**

  호출이 굉장히 많이 일어나서 스택이 꽉 차있는 상태가 되거나 차단되는 현상을 *블로킹 스크립트*라고 한다. 추가적인 작업을 위해 이전 작업이 완료될 때까지 기다려야 하는 상황이다.
  이 때 사용자는 어떤 일도 할 수 없다. 스택이 차단되기 때문이다. 단일 스레드 언어인 자바스크립트는 스택 내부의 함수가 값을 반환하지 않는 한 다른 작업이 불가능하다. 이를 방지하기 위해, 웹페이지가 망가지지 않고 사용자를 위한 유동적인 UI를 위해 비동기 콜백을 사용한다.

  **비동기 콜백** - 코드의 일부를 실행하고 나중에 실행할 콜백 함수를 제공하는 것이다.

  **WebAPI** - 브라우저가 비동기 이벤트를 처리하기 위해 만든 스레드. DOM 이벤트, http 요청, setTimeout 등과 같은 비동기 이벤트를 처리한다.

  1. 호출 스택에 push
  2. WebAPI 실행이 끝나면 콜백을 큐에 push
  3. 이벤트 루프는 큐에서 콜백을 실행하고 스택이 비어있으면 스택에 push

  각 메시지 또는 콜백은 다른 메시지가 처리되기 전에 완전히 처리됨